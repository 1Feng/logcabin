Import('env')

src = [
    "ClientService.cc",
    "Globals.cc",
    "LogManager.cc",
    "#build/Server/InternalLog.pb.o",
]

env.StaticLibrary("LogCabinServer",
                  src,
                  CPPPATH = [ "#" ])

env.Program("LogCabin", "Main.cc",
            LIBPATH = [
                "#build/Server",
                "#build/Storage",
                "#build/Protocol",
                "#build/RPC",
                "#build/Event",
                "#build/Core",
            ],
            LIBS = [ "libLogCabinServer",
                     "libLogCabinStorage",
                     "libLogCabinProtocol",
                     "libLogCabinRPC",
                     "libLogCabinEvent",
                     "libLogCabinCore",
                     "pthread", "protobuf", "rt", "cryptopp",
                     "event_core-2.0", "event_pthreads-2.0" ],
            CPPPATH = [ "#include", "#" ])

env.Protoc([],
           "InternalLog.proto",
           PROTOCPROTOPATH = ['.'],
           PROTOCPYTHONOUTDIR = None,
           PROTOCOUTDIR = '.')

env.StaticObject("#build/Server/InternalLog.pb.o",
                 "#build/Server/InternalLog.pb.cc",
                 CPPPATH = "#",
                 CXXFLAGS = "-std=c++0x")
